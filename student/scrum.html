<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>데일리 스크럼 - AI-X 학생 시스템</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-orange-50 to-yellow-100">
  <!-- 네비게이션 -->
  <nav class="bg-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center space-x-4">
          <a href="index.html" class="text-orange-600 hover:text-orange-800">← 메인으로</a>
          <h1 class="text-2xl font-bold text-orange-700">✍️ 데일리 스크럼</h1>
        </div>
        <div class="flex items-center space-x-4">
          <span class="text-gray-600">김수강</span>
          <span class="text-gray-600">1조 - AI 혁신팀</span>
        </div>
      </div>
    </div>
  </nav>

  <!-- 메인 콘텐츠 -->
  <div class="max-w-6xl mx-auto p-6">
    <!-- 헤더 정보 -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <div class="flex justify-between items-center">
        <div>
          <h2 class="text-3xl font-bold text-gray-800 mb-2">데일리 스크럼 기록</h2>
          <p class="text-gray-600">매일 작업 내용을 기록하고 팀과 공유하세요</p>
        </div>
        <div class="text-right">
          <div class="text-2xl font-bold text-orange-600">15/22</div>
          <div class="text-sm text-gray-500">이번 달 작성</div>
        </div>
      </div>
    </div>



    <!-- 활동 캘린더 (깃허브 잔디 스타일) -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-xl font-semibold">📈 활동 현황</h3>
        <div class="flex items-center space-x-4 text-sm text-gray-600">
          <span>적음</span>
          <div class="flex space-x-1">
            <div class="w-3 h-3 bg-gray-100 border border-gray-200 rounded-sm"></div>
            <div class="w-3 h-3 bg-green-100 border border-green-200 rounded-sm"></div>
            <div class="w-3 h-3 bg-green-300 border border-green-400 rounded-sm"></div>
            <div class="w-3 h-3 bg-green-500 border border-green-600 rounded-sm"></div>
            <div class="w-3 h-3 bg-green-700 border border-green-800 rounded-sm"></div>
          </div>
          <span>많음</span>
        </div>
      </div>

      <!-- 월별 라벨 -->
      <div class="mb-3">
        <div id="monthLabels" class="flex justify-between text-xs text-gray-500 mb-2">
          <!-- 동적으로 생성됨 -->
        </div>
      </div>

      <!-- 요일 라벨과 캘린더 -->
      <div class="flex">
        <!-- 요일 라벨 -->
        <div class="flex flex-col space-y-1 text-xs text-gray-500 mr-3 justify-start pt-2">
          <div class="h-3"></div>
          <div class="h-3 flex items-center">월</div>
          <div class="h-3"></div>
          <div class="h-3 flex items-center">수</div>
          <div class="h-3"></div>
          <div class="h-3 flex items-center">금</div>
          <div class="h-3"></div>
        </div>
        
        <!-- 캘린더 그리드 -->
        <div id="activityCalendar" class="flex-1 overflow-x-auto">
          <!-- 동적으로 생성됨 -->
        </div>
      </div>

      <!-- 통계 정보 -->
      <div class="mt-6 grid md:grid-cols-3 gap-4">
        <div class="bg-gradient-to-r from-orange-50 to-orange-100 p-4 rounded-lg">
          <div class="text-2xl font-bold text-orange-600">5일</div>
          <div class="text-sm text-gray-600">연속 작성 기록</div>
        </div>
        <div class="bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg">
          <div class="text-2xl font-bold text-green-600">68일</div>
          <div class="text-sm text-gray-600">총 작성 일수</div>
        </div>
        <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg">
          <div class="text-2xl font-bold text-blue-600">15일</div>
          <div class="text-sm text-gray-600">이번 달 작성</div>
        </div>
      </div>
    </div>

    <!-- 주간 요약 -->
    <div class="bg-white rounded-xl shadow-lg p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-xl font-semibold">주간 요약</h3>
        <div class="flex items-center space-x-4">
          <div class="relative">
            <select id="weekSelector" class="appearance-none bg-white border border-gray-300 rounded-lg px-4 py-2 pr-8 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500">
              <!-- 동적으로 생성됨 -->
            </select>
            <div class="absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none">
              <svg class="w-4 h-4 fill-current text-gray-500" viewBox="0 0 20 20">
                <path d="M7 7l3-3 3 3m0 6l-3 3-3-3"></path>
              </svg>
            </div>
          </div>
        </div>
      </div>

      <!-- 선택된 주의 요약 통계 -->
      <div id="weeklyStats" class="grid md:grid-cols-4 gap-4 mb-6">
        <!-- 동적으로 생성됨 -->
      </div>

      <!-- 주별 상세 기록 -->
      <div id="weeklyDetails" class="space-y-6">
        <!-- 동적으로 생성됨 -->
      </div>
    </div>
  </div>

  <script>
    // 목업 데이터
    const SCRUM_DATA = {
      recent: [
        {
          date: '2025-01-22',
          yesterday: 'API 문서 작성 완료, 데이터베이스 스키마 최종 검토',
          today: '중간발표 자료 작성, 프론트엔드 연동 테스트',
          blockers: '발표 자료 템플릿 확인 필요'
        },
        {
          date: '2025-01-21',
          yesterday: '사용자 인증 기능 구현, 단위 테스트 작성',
          today: 'API 문서 작성, 팀 회의 참석',
          blockers: ''
        },
        {
          date: '2025-01-20',
          yesterday: '프로젝트 환경 설정, Git 저장소 구성',
          today: '사용자 인증 API 개발 시작',
          blockers: 'Docker 환경 설정 이슈'
        },
        {
          date: '2025-01-19',
          yesterday: '요구사항 분석 문서 작성',
          today: '개발 환경 구축, 프로젝트 초기 설정',
          blockers: ''
        },
        {
          date: '2025-01-17',
          yesterday: '팀 킥오프 미팅 참석',
          today: '요구사항 분석 시작',
          blockers: '클라이언트 요구사항 명확화 필요'
        },
        {
          date: '2025-01-16',
          yesterday: '프로젝트 계획 수립',
          today: '팀 구성 및 역할 분담',
          blockers: ''
        },
        {
          date: '2025-01-15',
          yesterday: 'UI/UX 디자인 리뷰',
          today: '데이터베이스 설계 시작',
          blockers: ''
        }
      ]
    };

    // 유틸리티 함수
    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('ko-KR', { 
        month: 'long', 
        day: 'numeric',
        weekday: 'short'
      });
    }

    function showNotification(message, type = 'info') {
      const colors = {
        'success': 'bg-green-100 text-green-800',
        'warning': 'bg-yellow-100 text-yellow-800',
        'error': 'bg-red-100 text-red-800',
        'info': 'bg-blue-100 text-blue-800'
      };
      
      const notif = document.createElement('div');
      notif.className = `fixed top-4 right-4 ${colors[type]} px-6 py-4 rounded-lg shadow-lg z-50 transition-all duration-300`;
      notif.textContent = message;
      document.body.appendChild(notif);
      setTimeout(() => {
        notif.style.opacity = '0';
        setTimeout(() => notif.remove(), 300);
      }, 3000);
    }

    // 주간 드롭다운 옵션 생성
    function generateWeekOptions() {
      const selector = document.getElementById('weekSelector');
      const options = [];
      
      // 과정 기간 설정 (7월 4일 ~ 9월 4일)
      const courseStart = new Date(2025, 6, 4); // 7월 4일 (월은 0부터 시작)
      const courseEnd = new Date(2025, 8, 4);   // 9월 4일
      const today = new Date(2025, 7, 13);      // 현재 날짜 8월 13일
      
      // 과정 시작일의 첫 번째 월요일 찾기
      const firstMonday = new Date(courseStart);
      firstMonday.setDate(courseStart.getDate() - courseStart.getDay() + 1);
      if (firstMonday < courseStart) {
        firstMonday.setDate(firstMonday.getDate() + 7);
      }
      
      // 현재 주 계산 (현재 날짜가 속한 주의 월요일)
      const currentWeekStart = new Date(today);
      currentWeekStart.setDate(today.getDate() - today.getDay() + 1);
      
      // 과정 기간 내의 주간 옵션 생성
      let weekCounter = 0;
      for (let weekStart = new Date(firstMonday); weekStart <= courseEnd; weekStart.setDate(weekStart.getDate() + 7)) {
        const weekEnd = new Date(weekStart);
        weekEnd.setDate(weekStart.getDate() + 4); // 금요일까지
        
        // 과정 종료일을 넘어가지 않도록 조정
        if (weekEnd > courseEnd) {
          weekEnd.setTime(courseEnd.getTime());
        }
        
        const weekLabel = `${weekStart.getMonth() + 1}월 ${weekStart.getDate()}일 - ${weekEnd.getMonth() + 1}월 ${weekEnd.getDate()}일`;
        
        // 현재 주인지 확인
        const isCurrentWeek = weekStart.getTime() === currentWeekStart.getTime();
        
        options.push({
          value: weekCounter,
          label: isCurrentWeek ? `이번 주 (${weekLabel})` : `${weekCounter + 1}주차 (${weekLabel})`,
          startDate: new Date(weekStart),
          endDate: new Date(weekEnd),
          isCurrentWeek: isCurrentWeek
        });
        
        weekCounter++;
      }
      
      // 현재 주부터 역순으로 정렬 (최신이 위로)
      const currentWeekIndex = options.findIndex(opt => opt.isCurrentWeek);
      const reorderedOptions = [];
      
      // 현재 주부터 첫 주까지
      for (let i = currentWeekIndex; i >= 0; i--) {
        reorderedOptions.push({
          ...options[i],
          value: currentWeekIndex - i
        });
      }
      
      selector.innerHTML = reorderedOptions.map(option => 
        `<option value="${option.value}">${option.label}</option>`
      ).join('');
      
      return reorderedOptions;
    }

    // 선택된 주의 요약 생성
    function generateWeeklySummary() {
      const selector = document.getElementById('weekSelector');
      const selectedWeek = parseInt(selector.value) || 0;
      const statsContainer = document.getElementById('weeklyStats');
      const detailsContainer = document.getElementById('weeklyDetails');
      
      // 과정 기간 설정
      const courseStart = new Date(2025, 6, 4); // 7월 4일
      const today = new Date(2025, 7, 13);      // 현재 날짜 8월 13일
      
      // 현재 주 계산
      const currentWeekStart = new Date(today);
      currentWeekStart.setDate(today.getDate() - today.getDay() + 1);
      
      // 선택된 주의 시작일과 종료일 계산
      const weekStart = new Date(currentWeekStart);
      weekStart.setDate(currentWeekStart.getDate() - (selectedWeek * 7));
      const weekEnd = new Date(weekStart);
      weekEnd.setDate(weekStart.getDate() + 4); // 금요일까지
      
      // 해당 주의 스크럼 데이터 필터링
      const weekScrums = SCRUM_DATA.recent.filter(scrum => {
        const scrumDate = new Date(scrum.date);
        return scrumDate >= weekStart && scrumDate <= weekEnd;
      });
      
      // 주간 통계 계산
      const weekStats = {
        totalDays: weekScrums.length,
        completedTasks: weekScrums.reduce((total, s) => total + s.yesterday.split(',').length, 0),
        plannedTasks: weekScrums.reduce((total, s) => total + s.today.split(',').length, 0),
        blockers: weekScrums.filter(s => s.blockers.trim()).length
      };
      
      // 통계 카드 렌더링
      // statsContainer.innerHTML = `
      //   <div class="bg-gradient-to-r from-blue-50 to-blue-100 p-4 rounded-lg text-center">
      //     <div class="text-2xl font-bold text-blue-600">${weekStats.totalDays}</div>
      //     <div class="text-sm text-gray-600">스크럼 작성</div>
      //   </div>
      //   <div class="bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg text-center">
      //     <div class="text-2xl font-bold text-green-600">${weekStats.completedTasks}</div>
      //     <div class="text-sm text-gray-600">완료된 작업</div>
      //   </div>
      //   <div class="bg-gradient-to-r from-purple-50 to-purple-100 p-4 rounded-lg text-center">
      //     <div class="text-2xl font-bold text-purple-600">${weekStats.plannedTasks}</div>
      //     <div class="text-sm text-gray-600">계획된 작업</div>
      //   </div>
      //   <div class="bg-gradient-to-r from-red-50 to-red-100 p-4 rounded-lg text-center">
      //     <div class="text-2xl font-bold text-red-600">${weekStats.blockers}</div>
      //     <div class="text-sm text-gray-600">발생한 이슈</div>
      //   </div>
      // `;
      
      // 요일별 상세 기록 생성
      const daysOfWeek = ['월요일', '화요일', '수요일', '목요일', '금요일'];
      let detailsHTML = '';
      
      for (let i = 0; i < 5; i++) {
        const currentDay = new Date(weekStart);
        currentDay.setDate(weekStart.getDate() + i);
        const dayString = currentDay.toISOString().split('T')[0];
        const dayScrum = weekScrums.find(scrum => scrum.date === dayString);
        
        detailsHTML += `
          <div class="border-l-4 ${dayScrum ? 'border-green-500 bg-green-50' : 'border-gray-300 bg-gray-50'} pl-4 py-3">
            <div class="flex justify-between items-center mb-2">
              <h4 class="font-semibold text-gray-800">${daysOfWeek[i]}</h4>
              <span class="text-sm text-gray-500">${formatDate(dayString)}</span>
            </div>
            
            ${dayScrum ? `
              <div class="grid md:grid-cols-3 gap-4 text-sm">
                <div>
                  <div class="font-medium text-blue-600 mb-1">🟦 완료한 작업</div>
                  <p class="text-gray-700">${dayScrum.yesterday}</p>
                </div>
                <div>
                  <div class="font-medium text-green-600 mb-1">🟩 계획한 작업</div>
                  <p class="text-gray-700">${dayScrum.today}</p>
                </div>
                <div>
                  <div class="font-medium text-red-600 mb-1">🟥 이슈/블로커</div>
                  <p class="text-gray-700">${dayScrum.blockers || '없음'}</p>
                </div>
              </div>
            ` : `
              <p class="text-gray-500 text-sm">스크럼 기록이 없습니다.</p>
            `}
          </div>
        `;
      }
      
      detailsContainer.innerHTML = detailsHTML;
    }

    // 활동 캘린더 생성 (개선된 깃허브 스타일)
    function generateActivityCalendar() {
      const calendar = document.getElementById('activityCalendar');
      const monthLabels = document.getElementById('monthLabels');
      
      // 과정 기간 설정
      const courseStart = new Date(2025, 6, 4); // 7월 4일
      const courseEnd = new Date(2025, 8, 4);   // 9월 4일
      const today = new Date(2025, 7, 13);      // 현재 날짜 8월 13일
      
      // 과정 시작일의 첫 번째 일요일 찾기 (캘린더 시작점)
      const firstSunday = new Date(courseStart);
      firstSunday.setDate(courseStart.getDate() - courseStart.getDay());
      
      // 과정 기간 내 활동 데이터 생성
      const activityData = {};
      for (let d = new Date(courseStart); d <= courseEnd; d.setDate(d.getDate() + 1)) {
        const dateStr = d.toISOString().split('T')[0];
        
        // 과정이 진행된 날짜만 데이터 생성 (현재 날짜까지)
        if (d <= today) {
          const random = Math.random();
          let level = 0;
          
          // 평일만 활동 (월~금)
          if (d.getDay() >= 1 && d.getDay() <= 5) {
            if (random > 0.2) level = 1;
            if (random > 0.4) level = 2;
            if (random > 0.6) level = 3;
            if (random > 0.8) level = 4;
          }
          
          activityData[dateStr] = level;
        }
      }

      // 월별 라벨 생성 (과정 기간 내)
      const months = ['7월', '8월', '9월'];
      monthLabels.innerHTML = months.map(month => 
        `<span class="flex-1 text-center">${month}</span>`
      ).join('');

      // 과정 기간의 주 수 계산
      const totalDays = Math.ceil((courseEnd - firstSunday) / (1000 * 60 * 60 * 24));
      const totalWeeks = Math.ceil(totalDays / 7);

      // 캘린더 그리드 생성 (주별로)
      let calendarHTML = '<div class="grid grid-flow-col gap-1">';
      
      for (let week = 0; week < totalWeeks; week++) {
        calendarHTML += '<div class="grid grid-rows-7 gap-1">';
        
        for (let day = 0; day < 7; day++) {
          const currentDate = new Date(firstSunday);
          currentDate.setDate(firstSunday.getDate() + (week * 7) + day);
          
          // 과정 기간 밖이거나 미래 날짜
          if (currentDate < courseStart || currentDate > courseEnd || currentDate > today) {
            calendarHTML += '<div class="w-30 h-3"></div>'; // 빈 공간
          } else {
            const dateStr = currentDate.toISOString().split('T')[0];
            const level = activityData[dateStr] || 0;
            
            // 주말 처리
            if (currentDate.getDay() === 0 || currentDate.getDay() === 6) {
              calendarHTML += '<div class="w-3 h-3 bg-gray-50 border border-gray-100 rounded-sm" title="주말"></div>';
            } else {
              const colors = [
                'bg-gray-100 border-gray-200',     // 0 - 활동 없음
                'bg-green-100 border-green-200',   // 1 - 낮은 활동
                'bg-green-300 border-green-400',   // 2 - 보통 활동
                'bg-green-500 border-green-600',   // 3 - 높은 활동
                'bg-green-700 border-green-800'    // 4 - 매우 높은 활동
              ];
              
              calendarHTML += `
                <div class="w-30 h-3 ${colors[level]} border rounded-sm cursor-pointer transition-all duration-200 hover:ring-2 hover:ring-orange-400 hover:scale-110" 
                     title="${formatDate(dateStr)}: ${level > 0 ? '스크럼 작성함' : '작성 안함'}"
                     data-date="${dateStr}" data-level="${level}">
                </div>
              `;
            }
          }
        }
        
        calendarHTML += '</div>';
      }
      
      calendarHTML += '</div>';
      calendar.innerHTML = calendarHTML;
    }



    // 초기화
    document.addEventListener('DOMContentLoaded', function() {
      // 주간 드롭다운 옵션 생성
      generateWeekOptions();
      
      // 드롭다운 변경 이벤트 리스너
      document.getElementById('weekSelector').addEventListener('change', generateWeeklySummary);
      
      // 초기 렌더링
      generateWeeklySummary();
      generateActivityCalendar();
    });
  </script>
</body>
</html>
