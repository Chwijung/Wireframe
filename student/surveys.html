<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>사전 설문 - AI-X 학생 시스템</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gradient-to-br from-purple-50 to-blue-100">
  <!-- 네비게이션 -->
  <nav class="bg-white shadow-lg">
    <div class="max-w-7xl mx-auto px-4">
      <div class="flex justify-between items-center py-4">
        <div class="flex items-center space-x-4">
          <a href="index.html" class="text-purple-600 hover:text-purple-800">← 메인으로</a>
          <h1 class="text-2xl font-bold text-purple-700">📝 사전 설문</h1>
        </div>
        <div class="flex items-center space-x-4">
          <span class="text-gray-600">김수강</span>
          <span class="text-gray-600">1조 - AI 혁신팀</span>
        </div>
      </div>
    </div>
  </nav>

  <!-- 메인 콘텐츠 -->
  <div class="max-w-4xl mx-auto p-6">
    <!-- 헤더 -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <h2 class="text-3xl font-bold text-gray-800 mb-2">필수 설문 응답</h2>
      <p class="text-gray-600">과정 개선을 위한 설문에 참여해주세요</p>
    </div>

    <!-- 설문 목록 -->
    <div id="surveysList" class="space-y-6">
      <!-- 동적으로 채워짐 -->
    </div>
  </div>

  <!-- 설문 응답 모달 -->
  <div id="surveyModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
    <div class="bg-white rounded-xl max-w-3xl w-full mx-4 max-h-screen overflow-y-auto">
      <div class="p-6">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-xl font-semibold" id="surveyTitle">설문 응답</h3>
          <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">✕</button>
        </div>
        
        <div id="surveyContent">
          <!-- 동적으로 채워짐 -->
        </div>
      </div>
    </div>
  </div>

  <script>
    // 간단한 설문 데이터
    const SURVEYS_DATA = [
      {
        id: 1,
        title: '팀 빌딩 사전 설문',
        description: '팀 편성을 위한 기본 정보 수집',
        status: 'completed',
        completedDate: '2024-01-16',
        estimatedTime: '5분'
      },
      {
        id: 2,
        title: '중간 평가 설문',
        description: '과정 중반부 만족도 및 개선사항 조사',
        status: 'available',
        dueDate: '2025-01-30',
        estimatedTime: '8분',
        questions: [
          {
            id: 1,
            type: 'radio',
            question: '현재 과정에 대한 전반적인 만족도는?',
            options: ['매우 만족', '만족', '보통', '불만족', '매우 불만족'],
            required: true
          },
          {
            id: 2,
            type: 'checkbox',
            question: '가장 도움이 되는 부분은? (복수선택)',
            options: ['이론 수업', '프로젝트 실습', '멘토링', '팀 활동'],
            required: true
          },
          {
            id: 3,
            type: 'text',
            question: '개선이 필요한 부분이나 건의사항이 있다면 자유롭게 작성해주세요.',
            required: false
          }
        ]
      },
      {
        id: 3,
        title: '최종 평가 설문',
        description: '전체 과정 완료 후 종합 평가',
        status: 'upcoming',
        openDate: '2025-02-15',
        estimatedTime: '10분'
      }
    ];

    function getStatusBadge(status) {
      const statusConfig = {
        'completed': { class: 'bg-green-100 text-green-800', text: '✅ 완료' },
        'available': { class: 'bg-purple-100 text-purple-800', text: '📝 응답 가능' },
        'upcoming': { class: 'bg-blue-100 text-blue-800', text: '⏰ 예정' }
      };
      
      const config = statusConfig[status];
      return `<span class="px-3 py-1 rounded-full text-sm font-medium ${config.class}">${config.text}</span>`;
    }

    function formatDate(dateString) {
      const date = new Date(dateString);
      return date.toLocaleDateString('ko-KR', { 
        month: 'long', 
        day: 'numeric'
      });
    }

    function calculateDday(dueDate) {
      const today = new Date();
      const due = new Date(dueDate);
      const diffTime = due - today;
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
      
      if (diffDays <= 0) return '마감';
      if (diffDays === 1) return 'D-1';
      return `D-${diffDays}`;
    }

    function renderSurveys() {
      const container = document.getElementById('surveysList');
      
      container.innerHTML = SURVEYS_DATA.map(survey => `
        <div class="bg-white rounded-xl shadow-lg p-6 border-l-4 ${
          survey.status === 'completed' ? 'border-green-500' : 
          survey.status === 'available' ? 'border-purple-500' : 'border-blue-500'
        }">
          <div class="flex justify-between items-start mb-4">
            <div class="flex-1">
              <div class="flex items-center space-x-3 mb-3">
                <h3 class="text-xl font-bold text-gray-800">${survey.title}</h3>
                ${getStatusBadge(survey.status)}
                ${survey.status === 'available' && survey.dueDate ? 
                  `<span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-medium">${calculateDday(survey.dueDate)}</span>` : ''}
              </div>
              <p class="text-gray-600 mb-4">${survey.description}</p>
              
              <div class="flex items-center space-x-6 text-sm text-gray-500">
                <span>⏱️ 예상 시간: ${survey.estimatedTime}</span>
                ${survey.completedDate ? `<span>✅ 완료: ${formatDate(survey.completedDate)}</span>` : ''}
                ${survey.dueDate ? `<span>📅 마감: ${formatDate(survey.dueDate)}</span>` : ''}
                ${survey.openDate ? `<span>📅 시작: ${formatDate(survey.openDate)}</span>` : ''}
              </div>
            </div>
          </div>

          <div class="flex justify-end">
            ${survey.status === 'available' ? `
              <button onclick="startSurvey(${survey.id})" class="bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium">
                📝 설문 시작
              </button>
            ` : survey.status === 'completed' ? `
              <button class="bg-green-600 text-white px-6 py-3 rounded-lg font-medium cursor-default">
                ✅ 응답 완료
              </button>
            ` : `
              <button class="bg-gray-400 text-white px-6 py-3 rounded-lg font-medium cursor-not-allowed" disabled>
                ⏰ 응답 기간 아님
              </button>
            `}
          </div>
        </div>
      `).join('');
    }

    function startSurvey(surveyId) {
      const survey = SURVEYS_DATA.find(s => s.id === surveyId);
      if (!survey || survey.status !== 'available') return;

      document.getElementById('surveyTitle').textContent = survey.title;
      document.getElementById('surveyContent').innerHTML = `
        <div class="space-y-6">
          <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
            <h4 class="font-semibold text-purple-800 mb-2">📋 설문 안내</h4>
            <div class="text-sm text-purple-700">
              <p>• 예상 소요시간: ${survey.estimatedTime}</p>
              <p>• 정직한 답변 부탁드립니다</p>
              <p>• 제출 후 수정이 불가능합니다</p>
            </div>
          </div>

          <form id="surveyForm" class="space-y-6">
            ${survey.questions.map((question, index) => `
              <div class="bg-gray-50 rounded-lg p-6">
                <h5 class="font-semibold text-gray-800 mb-4">
                  ${index + 1}. ${question.question}
                  ${question.required ? '<span class="text-red-600 ml-1">*</span>' : ''}
                </h5>
                
                ${question.type === 'radio' ? `
                  <div class="space-y-3">
                    ${question.options.map(option => `
                      <label class="flex items-center space-x-3 cursor-pointer hover:bg-white p-3 rounded transition-colors">
                        <input type="radio" name="question_${question.id}" value="${option}" ${question.required ? 'required' : ''} class="text-purple-600 focus:ring-purple-500">
                        <span class="text-gray-700">${option}</span>
                      </label>
                    `).join('')}
                  </div>
                ` : question.type === 'checkbox' ? `
                  <div class="space-y-3">
                    ${question.options.map(option => `
                      <label class="flex items-center space-x-3 cursor-pointer hover:bg-white p-3 rounded transition-colors">
                        <input type="checkbox" name="question_${question.id}" value="${option}" class="text-purple-600 focus:ring-purple-500">
                        <span class="text-gray-700">${option}</span>
                      </label>
                    `).join('')}
                  </div>
                ` : `
                  <textarea name="question_${question.id}" rows="4" ${question.required ? 'required' : ''} class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="자유롭게 의견을 작성해주세요..."></textarea>
                `}
              </div>
            `).join('')}

            <div class="flex space-x-4">
              <button type="button" onclick="closeModal()" class="flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors font-medium">
                취소
              </button>
              <button type="submit" class="flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium">
                제출하기
              </button>
            </div>
          </form>
        </div>
      `;

      document.getElementById('surveyForm').addEventListener('submit', function(e) {
        e.preventDefault();
        submitSurvey(surveyId);
      });

      document.getElementById('surveyModal').classList.remove('hidden');
    }

    function submitSurvey(surveyId) {
      showNotification('설문 응답을 제출하는 중입니다...', 'info');

      setTimeout(() => {
        const survey = SURVEYS_DATA.find(s => s.id === surveyId);
        if (survey) {
          survey.status = 'completed';
          survey.completedDate = new Date().toISOString().split('T')[0];
        }

        closeModal();
        renderSurveys();
        showNotification('설문 응답이 완료되었습니다! 감사합니다.', 'success');
      }, 2000);
    }

    function closeModal() {
      document.getElementById('surveyModal').classList.add('hidden');
    }

    function showNotification(message, type = 'info') {
      const colors = {
        'success': 'bg-green-100 text-green-800',
        'error': 'bg-red-100 text-red-800',
        'info': 'bg-blue-100 text-blue-800'
      };
      
      const notif = document.createElement('div');
      notif.className = `fixed top-4 right-4 ${colors[type]} px-6 py-4 rounded-lg shadow-lg z-50 transition-all duration-300`;
      notif.textContent = message;
      document.body.appendChild(notif);
      setTimeout(() => {
        notif.style.opacity = '0';
        setTimeout(() => notif.remove(), 300);
      }, 3000);
    }

    // 초기화
    document.addEventListener('DOMContentLoaded', function() {
      renderSurveys();
    });
  </script>
</body>
</html>